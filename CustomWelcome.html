<!DOCTYPE html>
<html>
<head>
    <title>Welcome Message</title>
</head>
<body>
    <div id="welcomeMessage"></div>
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {
            // Fetch the user's display name using Microsoft Graph API
            fetch('/_api/SP.UserProfiles.PeopleManager/GetMyProperties', {
                headers: {
                    'Accept': 'application/json;odata=verbose'
                }
            })
            .then(response => response.json())
            .then(data => {
                var userName = data.d.DisplayName;
                var titleElement = document.querySelector('[data-automation-id="TitleTextId"]');
                if (titleElement) {
                    titleElement.innerText = "Welcome, " + userName + "!";
                }
            })
            .catch(error => console.error('Error fetching user properties:', error));
        });
    </script>
</body>
</html>